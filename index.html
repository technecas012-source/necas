<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NECAS Online Store</title>
<style>
:root{--gold:#d4af37;--navy:#0f172a;--bg:#f8f5f0;--text:#0f172a}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
header{background:var(--navy);color:white;padding:15px 0;position:fixed;width:100%;top:0;z-index:1000;border-bottom:5px solid var(--gold)}
.container{max-width:1400px;margin:auto;padding:0 15px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
.logo{font-size:2rem;font-weight:bold;display:flex;align-items:center;gap:10px}
.logo i{font-size:2.8rem;animation:pulse 3s infinite}
nav div{color:white;padding:10px 16px;border-radius:8px;cursor:pointer;transition:.3s}
nav div:hover{background:rgba(255,255,255,.2)}
.badge{position:absolute;top:-8px;right:-8px;background:var(--gold);color:var(--navy);width:22px;height:22px;border-radius:50%;font-size:0.9rem;display:flex;align-items:center;justify-content:center}
.main{margin-top:90px;padding:20px;flex:1}
h1{text-align:center;color:var(--gold);font-size:2.6rem;margin:20px 0}
.products{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:20px}
.card{background:white;border:3px solid var(--gold);border-radius:16px;overflow:hidden;box-shadow:0 8px 25px rgba(0,0,0,.15);transition:.3s;cursor:pointer;text-align:center}
.card:hover{transform:translateY(-12px)}
.card img{width:100%;height:190px;object-fit:cover;transition:0.3s;cursor:zoom-in}
.card h3{margin:10px 0;font-size:1.2rem;font-weight:bold}
.price{font-size:1.2rem;color:var(--gold);font-weight:bold}
.btn{background:var(--navy);color:white;padding:14px 30px;border:3px solid var(--gold);border-radius:50px;cursor:pointer;margin:10px;display:inline-block;transition:.3s}
.btn:hover{background:var(--gold);color:var(--navy)}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:9999;align-items:center;justify-content:center;padding:20px}
.modal-content{background:white;border:5px solid var(--gold);border-radius:20px;max-width:600px;width:95%;padding:30px;text-align:center;position:relative}
.close{position:absolute;top:10px;right:20px;font-size:2.8rem;cursor:pointer;color:var(--navy)}
#loader{position:fixed;inset:0;background:var(--navy);color:var(--gold);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:99999;font-size:3rem}
#loader i{font-size:8rem;margin-bottom:20px;animation:pulse 2s infinite}
.hidden{display:none}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.6}}
#preview{margin:10px 0;max-width:100%;height:auto;border:2px solid var(--gold);border-radius:12px}
input,textarea{width:100%;padding:8px;margin:8px 0;border:2px solid var(--gold);border-radius:8px}
</style>
</head>
<body>
<div id="loader"><i>âŒ›</i> Loading...</div>
<header>
<div class="container">
<div class="logo"><i>ðŸ›’</i> NECAS</div>
<nav>
<div onclick="showPage('home')">Home</div>
<div onclick="showPage('cart')">Cart <span class="badge" id="cartCount">0</span></div>
<div onclick="showLogin()">Login</div>
<div onclick="showPage('admin')">Admin</div>
</nav>
</div>
</header><main class="main" id="home">
<h1>NECAS Products</h1>
<div class="products" id="productList"></div>
</main><main class="main hidden" id="cart">
<h1>Cart</h1>
<div id="cartItems"></div>
<div id="totalAmount" style="margin:20px;font-weight:bold;font-size:1.2rem"></div>
<button class="btn" onclick="sendWhatsAppOrder()">Send Order via WhatsApp</button>
</main><main class="main hidden" id="admin">
<h1>Admin Panel</h1>
<div style="margin-bottom:20px">
<input id="pName" placeholder="Product Name">
<input id="pPrice" type="number" placeholder="Price">
<textarea id="pDesc" placeholder="Description"></textarea>
<input type="file" id="pImage" accept="image/*" onchange="previewImage(event)">
<img id="preview" src="" alt="Image Preview" class="hidden">
<button class="btn" onclick="addProduct()">Add Product</button>
</div>
<div id="adminList"></div>
</main><div id="loginModal" class="modal">
<div class="modal-content">
<span class="close" onclick="closeModal()">&times;</span>
<h2>Login</h2>
<input id="email" placeholder="Email">
<input id="pass" type="password" placeholder="Password">
<button class="btn" onclick="login()">Login</button>
</div>
</div><div id="productModal" class="modal">
<div class="modal-content">
<span class="close" onclick="closeModal()">&times;</span>
<img id="mImg" src="" alt="" style="width:100%;border-radius:12px;margin-bottom:15px">
<h3 id="mTitle"></h3>
<div class="price" id="mPrice"></div>
<p id="mDesc"></p>
<button class="btn" onclick="addToCart()">Add to Cart</button>
</div>
</div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script>
// Supabase config
const supabaseUrl = 'https://kjwhelyodlgocsnfxnon.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtqd2hlbHlvZGxnb2NzbmZ4bm9uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0NTAzODQsImV4cCI6MjA4MDAyNjM4NH0.ikVvyNjt_j3tG2v9EaknKVF1L2FzDlocdgY2YLQ6_qI';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

let cart = JSON.parse(localStorage.getItem('necas_cart')||'[]');
let currentProduct = null;

window.onload = async () => {
document.getElementById('loader').style.display = 'none';
await loadProducts();
renderCart();
};

// --- PRODUCTS ---
async function loadProducts() {
const { data, error } = await supabase.from('products').select('*').order('created_at', { ascending: false });
const list = document.getElementById('productList');
list.innerHTML = '';
if (data && data.length) {
data.forEach(p => {
let div = document.createElement('div');
div.className = 'card';
div.innerHTML = `<img src="${p.img}" alt="${p.title}"><h3>${p.title}</h3><div class="price">MK ${p.price.toLocaleString()}</div>`;
div.onclick = () => openProduct(p);
list.appendChild(div);
});
} else list.innerHTML = '<p style="text-align:center;color:var(--gold);font-size:1.8rem">No products yet</p>';
}

// --- MODALS ---
function openProduct(p) {
currentProduct = p;
document.getElementById('mImg').src = p.img;
document.getElementById('mTitle').textContent = p.title;
document.getElementById('mPrice').textContent = 'MK ' + p.price.toLocaleString();
document.getElementById('mDesc').textContent = p.desc || 'Premium quality';
document.getElementById('productModal').style.display = 'flex';
}

function closeModal() {
document.querySelectorAll('.modal').forEach(m => m.style.display='none');
}

// --- CART ---
function addToCart() {
if (!currentProduct) return;
cart.push(currentProduct);
localStorage.setItem('necas_cart', JSON.stringify(cart));
renderCart();
closeModal();
}

function renderCart() {
const c = document.getElementById('cartItems');
if (!cart.length) c.innerHTML = '<p style="text-align:center;padding:60px">Cart empty</p>';
else c.innerHTML = cart.map(p => `<div><b>${p.title}</b><br>MK ${p.price.toLocaleString()}</div>`).join('');
document.getElementById('cartCount').textContent = cart.length;
document.getElementById('totalAmount').textContent = 'Total: MK ' + cart.reduce((a,p)=>a+p.price,0).toLocaleString();
}

function sendWhatsAppOrder() {
if (!cart.length) { alert('Cart empty'); return; }
let msg = '*NECAS ORDER*%0A';
let total = 0;
cart.forEach(p => { msg += `â€¢ ${p.title} - MK ${p.price.toLocaleString()}%0A`; total += p.price; });
msg += `%0A*TOTAL: MK ${total.toLocaleString()}*`;
window.open('https://wa.me/265894404000?text=' + msg);
cart = [];
localStorage.setItem('necas_cart','[]');
renderCart();
}

// --- PAGE NAV ---
function showPage(p){document.querySelectorAll('.main').forEach(x=>x.classList.add('hidden'));document.getElementById(p).classList.remove('hidden');}

// --- LOGIN ---
function showLogin(){document.getElementById('loginModal').style.display='flex';}
async function login() {
const email = document.getElementById('email').value;
const pass = document.getElementById('pass').value;
const { data, error } = await supabase.auth.signInWithPassword({ email, password: pass });
if (error) alert(error.message);
else { closeModal(); alert('Logged in!'); }
}

// --- ADMIN ---
function previewImage(event){document.getElementById('preview').src = URL.createObjectURL(event.target.files[0]);document.getElementById('preview').classList.remove('hidden');}

async function addProduct() {
const user = await supabase.auth.getUser();
if (!user.data.user || user.data.user.email != 'admin@necas.com') { alert('Only admin'); return; }
const name = document.getElementById('pName').value.trim();
const price = parseInt(document.getElementById('pPrice').value);
const desc = document.getElementById('pDesc').value;
const file = document.getElementById('pImage').files[0];
if (!name || !price || !file) { alert('Fill all fields + image'); return; }

const { data: uploadData, error: uploadError } = await supabase.storage.from('products').upload(Date.now()+'.jpg', file);
if (uploadError) { alert(uploadError.message); return; }
const { data: urlData } = supabase.storage.from('products').getPublicUrl(uploadData.path);

const { error: insertError } = await supabase.from('products').insert({ title: name, price, desc, img: urlData.publicUrl });
if (insertError) { alert(insertError.message); return; }
alert('Product added!');
document.getElementById('pName').value = document.getElementById('pPrice').value = document.getElementById('pDesc').value = '';
document.getElementById('pImage').value = '';
document.getElementById('preview').classList.add('hidden');
await loadProducts();
}
</script></body>
</html>